DELIMITER $$

CREATE FUNCTION UDF_GET_MOVIE_BUDGET_LEVEL(MOVIE_BUDGET DECIMAL(15,2))
RETURNS VARCHAR(10)
DETERMINISTIC
BEGIN
    DECLARE BUDGET_LEVEL VARCHAR(10);

    IF MOVIE_BUDGET < 100000000 THEN
        SET BUDGET_LEVEL := 'Нисък';
    ELSEIF MOVIE_BUDGET >= 100000000 AND MOVIE_BUDGET <= 200000000 THEN
        SET BUDGET_LEVEL := 'Стандартен';
    ELSE
        SET BUDGET_LEVEL := 'Висок';
    END IF;

    RETURN BUDGET_LEVEL;
END $$

DELIMITER ;

SELECT MOVIE_TITLE AS "Име на филма", MOVIE_BUDGET AS "Бюджет на филма", UDF_GET_MOVIE_BUDGET_LEVEL(MOVIE_BUDGET) AS "Ниво на бюджета"
FROM MARVEL_MOVIES;
